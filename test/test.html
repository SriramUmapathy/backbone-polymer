<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <script src="../bower_components/webcomponentsjs/webcomponents.min.js"></script>
  <script src="../node_modules/mocha/mocha.js"></script>
  <script src="../node_modules/web-component-tester/browser.js"></script>

  <!-- lib dependencies -->
  <script src="../node_modules/yobo/node_modules/underscore/underscore.js"></script>
  <script src="../node_modules/yobo/node_modules/backbone/backbone.js"></script>
  <script src="../backbone-polymer-mixin.js"></script>

  <link rel="import" href="../bower_components/polymer/polymer.html">
  <link rel="import" href="../sample-element/sample-element.html">

  <link rel="import" href="../sample-collection-element/backbone-ish-collection.html">
</head>
<body>
  <sample-element id="sample"></sample-element>
  <backbone-ish-collection id="collection1"></backbone-ish-collection>
  <script>
    describe('<sample-element>', function() {

      it('Renders the greeting property', function() {
        expect(document.querySelector('#greeting').innerHTML).to.equal('Hello!');
      });

      it("Responds to changes in the property's value", function() {
        var sample = document.querySelector('#sample');
        expect(sample.innerHTML).to.not.match(/>Modified!</);
        sample.greeting = 'Modified!';
        expect(sample.innerHTML).to.match(/>Modified!</);
      });

    });

    describe("backbone-polymer", function() {

      describe("sample collection, no webpack", function() {

        it("When used without 'require' it exists as a BackbonePolymerNotify global function", function() {
          expect(BackbonePolymerNotify).to.be.a('function');
        });

        it("Can be used on an element with a property that is a backbone collection", function() {

          var element1 = document.querySelector('#collection1');
          expect(element1).to.exist;

          var c1 = new Backbone.Collection();
          c1.add({type: 'text', content: 'As initialized.'});

          element1.set('collection', c1);

          expect(element1.innerHTML).to.match(/>As initialized.</);

        });
/*
        it("Can be set up to notify the element about changes so they are rendered", function() {

          var element1 = document.querySelector('#collection1');

          var c1 = new Backbone.Collection({
            polymerNotify: BackbonePolymerNotify
          });
          var m1 = c1.add({type: 'text', content: 'As initialized 2.'});

          c1.polymerNotify(element1, 'collection');

          m1.set('content', 'as modified');

        });

        it("Uses 'this' for the collection, like a regular Backbone member function", function() {

          var element1 = document.querySelector('#collection1');

          var c1 = new Backbone.Collection();
          BackbonePolymerNotify.call(c1, element1, 'collection');



        });
*/
      });

    });
  </script>
</body>
</html>
